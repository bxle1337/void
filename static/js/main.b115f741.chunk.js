(this.webpackJsonpruby=this.webpackJsonpruby||[]).push([[0],{129:function(e,t,c){"use strict";c.r(t);var s=c(0),n=c(25),r=c.n(n),a=c(14),i=c.n(a),o=c(15),l=c.n(o),d=c(24),u=c(20),b=c(7),j=(c(122),c(123),c(30),c(127),c.p,c(130)),h=c(4),p=function(e){var t,c,n=e.id,r=(e.go,e.fetchedUser),a=e.Score,o=e.Fact,p=e.setPopout,f=Object(s.useState)("white"),m=Object(u.a)(f,2),O=m[0],x=m[1];return i.a.subscribe((function(e){var t=e.detail,c=t.type,s=t.data;if("VKWebAppUpdateConfig"===c){var n=document.createAttribute("scheme");n.value=s.scheme?s.scheme:"bright_light",x("bright_light"!==s.scheme?"black":"white"),document.body.attributes.setNamedItem(n),console.log(s)}})),Object(h.jsx)(b.n,{id:n,children:Object(h.jsxs)("div",{className:"rootPanel",children:[Object(h.jsx)(b.o,{children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"}),Object(h.jsxs)(b.l,{children:[Object(h.jsx)("center",{children:Object(h.jsxs)("div",{className:"mainblock",children:[Object(h.jsx)("h1",{className:"score",id:"score",children:a.toFixed(0)}),Object(h.jsx)(b.t,{weight:"regular",style:{marginTop:-80},children:(t=a,c=["\u0441\u0435\u043a\u0443\u043d\u0434\u0430","\u0441\u0435\u043a\u0443\u043d\u0434\u044b","\u0441\u0435\u043a\u0443\u043d\u0434"],c[t%100>4&&t%100<20?2:[2,0,1,1,1,2][t%10<5?t%10:5]])})]})}),Object(h.jsx)(b.h,{children:Object(h.jsx)("center",{children:o})})]}),r&&Object(h.jsx)(b.i,{vertical:"bottom",style:{marginBottom:16},children:Object(h.jsxs)(b.h,{style:{display:"flex"},children:[Object(h.jsx)(b.g,{size:"s",stretched:!0,mode:"secondary",style:{marginRight:8,color:"black"===O?"white":"black"},children:" \u0422\u043e\u043f "}),Object(h.jsx)(b.g,{size:"s",stretched:!0,mode:"secondary",style:{color:"black"===O?"white":"black"},onClick:function(){p(Object(h.jsxs)(b.a,{onClose:function(){return p(null)},children:[Object(h.jsx)(b.h,{children:Object(h.jsx)(b.k,{header:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0435\u0440\u0435\u0432\u043e\u0434",mode:"default",children:"\u0422\u0432\u043e\u044f \u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0435\u0440\u0435\u0432\u043e\u0434, \u043f\u0435\u0440\u0435\u0439\u0434\u044f \u043f\u043e \u043d\u0435\u0439, \u0438\u0433\u0440\u043e\u043a \u0441\u043c\u043e\u0436\u0435\u0442 \u043f\u0435\u0440\u0435\u0432\u0435\u0441\u0442\u0438 \u0442\u0435\u0431\u0435 \u0441\u0435\u043a\u0443\u043d\u0434\u044b... \u0425\u043e\u0442\u044f.. \u0417\u0430\u0447\u0435\u043c \u043e\u043d\u0438 \u0442\u0435\u0431\u0435?"})}),Object(h.jsxs)(b.s,{disabled:!0,after:Object(h.jsx)(j.a,{fill:"black"===O?"white":"black",onClick:Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.send("VKWebAppCopyText",{text:"vk.com/app7966180#t"+r.id});case 2:1==e.sent.result?i.a.send("VKWebAppTapticNotificationOccurred",{type:"success"}):i.a.send("VKWebAppTapticNotificationOccurred",{type:"error"});case 4:case"end":return e.stop()}}),e)})))}),children:["vk.com/app7966180#t",r.id]}),Object(h.jsx)(b.b,{autoclose:!0,mode:"destructive",children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]}))},children:" \u041f\u0435\u0440\u0435\u0432\u043e\u0434 "})]})})]})})},f=c.p+"static/media/persik.ae9f0072.png",m=function(e){return Object(h.jsxs)(b.n,{id:e.id,children:[Object(h.jsx)(b.o,{left:Object(h.jsx)(b.p,{onClick:e.go,"data-to":"home"}),children:"Persik"}),Object(h.jsx)("img",{className:"Persik",src:f,alt:"Persik The Cat"})]})},O=new WebSocket("wss://freevkstickers.ru:9000"),x=function(){var e=Object(s.useState)("home"),t=Object(u.a)(e,2),c=t[0],n=t[1],r=Object(s.useState)(null),a=Object(u.a)(r,2),o=a[0],j=a[1],f=Object(s.useState)(Object(h.jsx)(b.r,{size:"large"})),x=Object(u.a)(f,2),v=x[0],g=x[1],k=Object(s.useState)(0),y=Object(u.a)(k,2),w=y[0],S=y[1],C=Object(s.useState)(null),N=Object(u.a)(C,2),A=N[0],I=N[1];Object(s.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.send("VKWebAppGetUserInfo");case 2:t=e.sent,j(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}i.a.subscribe((function(e){var t=e.detail,c=t.type,s=t.data;if("VKWebAppUpdateConfig"===c){var n=document.createAttribute("scheme");n.value=s.scheme?s.scheme:"client_light",document.body.attributes.setNamedItem(n)}})),function(){e.apply(this,arguments)}()}),[]);var W=function(e){n(e.currentTarget.dataset.to)};function K(){return(K=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.send("VKWebAppGetUserInfo");case 2:t=e.sent,O.send(JSON.stringify({event:"registration",params:window.location.search,user:t}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return O.onopen=function(e){!function(){K.apply(this,arguments)}()},O.onmessage=function(e){try{var t=JSON.parse(e.data);switch(t.event){case"setscore":S(+w+ +t.value);break;case"fact":I(t.value);break;case"transfercomplite":S(t.value);break;case"transferalert":g(Object(h.jsx)(b.d,{actions:[{title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",mode:"destructive",autoclose:!0}],actionsLayout:"vertical",onClose:function(){return g(null)},header:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0435\u0440\u0435\u0432\u043e\u0434",text:"".concat(t.about.first_name," \u043f\u0435\u0440\u0435\u0432\u0435\u043b \u0432\u0430\u043c ").concat(t.summa," \u0441\u0435\u043a\u0443\u043d\u0434")}));break;case"good":if(g(null),window.location.hash.indexOf("#t")>-1){var c=function(){var e=Object(d.a)(l.a.mark((function e(){var t,c,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=btoa(window.location.search),e.next=3,fetch("https://h154851.srv11.test-hf.su/void/api.php?action=getuser&key="+t+"&id="+s);case 3:return c=e.sent,e.next=6,c.json();case 6:"good"==(n=e.sent).status&&g(Object(h.jsxs)(b.a,{onClose:function(){return g(null)},children:[Object(h.jsx)(b.k,{header:"\u041e\u0448\u0438\u0431\u043a\u0430",mode:"error",id:"transferalert",style:{display:"none",color:"red",marginRight:8}}),Object(h.jsxs)(b.q,{before:Object(h.jsx)(b.f,{size:48,src:n.response.photo_200}),caption:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442 \u0432\u0430\u0448\u0438 \u0441\u0435\u043a\u0443\u043d\u0434\u044b",children:[n.response.first_name," ",n.response.last_name]}),Object(h.jsx)(b.j,{top:"\u0421\u0443\u043c\u043c\u0430",children:Object(h.jsx)(b.m,{id:"summa",type:"number"})}),Object(h.jsx)(b.b,{onClick:function(){var e=document.getElementById("summa").value;O.send(JSON.stringify({event:"transfer",params:window.location.search,toid:s,summa:e}))},children:"\u041f\u0435\u0440\u0435\u0432\u0435\u0441\u0442\u0438"}),Object(h.jsx)(b.b,{autoclose:!0,mode:"destructive",children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=window.location.hash.replace(/[^+\d]/g,"");c()}break;case"errortransfer":try{document.getElementById("transferalert").style.display="block",document.getElementById("transferalert").innerHTML=t.message}catch(n){}}}catch(n){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 "+n)}},Object(h.jsx)(b.c,{children:Object(h.jsx)(b.e,{children:Object(h.jsxs)(b.u,{activePanel:c,popout:v,children:[Object(h.jsx)(p,{id:"home",fetchedUser:o,go:W,setPopout:g,Score:w,Fact:A}),Object(h.jsx)(m,{id:"persik",go:W})]})})})};i.a.send("VKWebAppInit"),r.a.render(Object(h.jsx)(x,{}),document.getElementById("root"))},30:function(e,t,c){}},[[129,1,2]]]);
//# sourceMappingURL=main.b115f741.chunk.js.map